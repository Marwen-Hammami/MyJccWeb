{% extends "base.html.twig" %}
{% block body %}
<style>
.navigation {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 20px 0;
  color: #fff; /* Set color to white */
}

.navigation ul {
  display: flex;
  list-style: none;
  margin: 0;
  padding: 0;
}

.navigation li {
  margin: 0 10px;
}

.navigation span {
  display: inline-block;
  padding: 8px 12px;
  background-color: #005dff;
  color: #fff;
  border-radius: 4px;
  margin-right: 5px;
}
.navigation span:not(.current-page) {
  background-color: #ddd;
  color: #333;
}



.navigation .current-page {
  display: inline-block;
}
</style>


<h1>
		Recherche :</h1>
</br>
<input type="text" id="searchxx" class="form-control" placeholder="recherche selon Email">
<br/>
<div>
        <table id="t" class="table table-editable table-nowrap align-middle table-edits">
            <thead class="thead-dark">
                <tr>
                    <th>Rate</th>
                    <th>User</th>
                    <th>Film</th>
                    <th>Commentaire</th>
                    {#<th>QR Code</th>#}
                    <th>Date de vote</th>
                    <th>Vote</th>
                    <th>Modifier</th>
                    <th>Supprimer</th>
                </tr>
            </thead>
            <tbody id="all">
                {% for vote in votes %}
                    <tr>
                        <td>{{ vote.valeur }} etoile</td>
                        <td>{{ vote.idUser.nom}}</td>
                        <td>{{ vote.idFilm.Titre }}</td>
                        <td>{{ vote.commentaire }}</td>
                        <td>{{ vote.datevote|date('d/m/Y') }}</td>
                        <td>{{ vote.voteFilm }}</td>
                        <td style="width: 100px">
                            <a class="btn btn-outline-primary btn-sm edit" title="Edit"  href="{{ path('update_vote', {'id': vote.ID_Vote}) }}" >
                                <i class="fas fa-pencil-alt"></i>  
                            </a>
                        </td>
                        <td style="width: 100px">
                            <a class="btn btn-outline-secondary btn-sm delete" title="Delete"  href="{{ path('vote_delete', {'id': vote.ID_Vote}) }}" >
                                <i class="fas fa-trash"></i>    
                            </a>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
            <tbody id="searchtab"></tbody>
        </table>
    </div>
    <div class="navigation">
    {{ knp_pagination_render(list) }}
</div>

<script src="{{ asset('https://code.jquery.com/jquery-3.5.1.min.js') }}"></script>

<script>
	$(document).ready(function () {
$("#searchxx").keyup(function (e) { /* La variable value va prendre la valeur insérer dans le champ de texte
            afin d'effectuer la recherche */
var value = $(this).val();
/* Ajax est lancé lors du remplissage du champ texte dont l'id est
            « search » pour faire la recherche */

$.ajax({ /* l’url est une chaine de caractères contenant l’adresse où la requête est
                envoyée */
url: "{{ path('recherche_ajax') }}",
/* La méthode utilisée pour transférer les données est GET */
type: 'GET',
/*Ici search value va prendre la chaine entrée par un utilisateur dans la
                zone de recherche et sera placée après l’url */
data: {
'searchValue': value
},
/*Cette fonction permet de vider le contenu du tableau pour recevoir le
                nouveau contenu*/
success: function (resultats) {
if (resultats) {
$('#t tbody#searchtab').empty();
$.each(resultats, function (i, obj) {
$('#t tbody#all').hide();
$('#t tbody#searchtab').append('<tr><td> ' + obj.valeur + '</td><td> ' + obj.idUser.nom + '</td><td> ' + obj.idFilm.Titre + '</td><td> ' + obj.commentaire + '</td><td>' + obj.datevote + '</td><td>' + obj.voteFilm + '</td></tr>');
});
} else {
$('#t tbody#all').show();
$('#t tbody#searchtab').empty();
$('#t tbody#searchtab').fadeIn('fast');
}
}
});
return false;
});

});
</script>
{% endblock %}
